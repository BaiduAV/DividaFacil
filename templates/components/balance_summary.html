<!-- Balance Summary Component -->
<div class="balance-summary">
  <div class="section-header">
    <div class="section-icon">
      <div class="section-icon-inner" style="background: linear-gradient(135deg, #10b981, #059669);">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0012 4C7.272 4 3.25 5.14 0 7.25v12.5A48.416 48.416 0 0012 20.25c4.728 0 8.75-1.14 12-3.25V7.25A48.416 48.416 0 0012 4z"/>
        </svg>
      </div>
    </div>
    <div>
      <h2>Resumo de Saldos</h2>
      <p>Quem deve para quem</p>
    </div>
  </div>

  <div class="balance-cards-grid">
    {% if balances %}
      {% for balance in balances %}
      <div class="balance-card {% if balance.amount > 0 %}positive{% elif balance.amount < 0 %}negative{% else %}neutral{% endif %}">
        <div class="balance-users">
          <div class="user-info">
            <div class="user-avatar">{{ balance.from_user.name[0].upper() }}</div>
            <span class="user-name">{{ balance.from_user.name }}</span>
          </div>
          
          <div class="balance-arrow">
            {% if balance.amount > 0 %}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="arrow-receive">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18"/>
            </svg>
            {% elif balance.amount < 0 %}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="arrow-owe">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
            </svg>
            {% else %}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="arrow-neutral">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            {% endif %}
          </div>
          
          <div class="user-info">
            <div class="user-avatar">{{ balance.to_user.name[0].upper() }}</div>
            <span class="user-name">{{ balance.to_user.name }}</span>
          </div>
        </div>
        
        <div class="balance-amount">
          {% if balance.amount > 0 %}
            <span class="amount-label">{{ balance.from_user.name }} recebe</span>
            <span class="amount-value positive">R$ {{ "%.2f"|format(balance.amount)|replace(".", ",") }}</span>
          {% elif balance.amount < 0 %}
            <span class="amount-label">{{ balance.from_user.name }} deve</span>
            <span class="amount-value negative">R$ {{ "%.2f"|format(-balance.amount)|replace(".", ",") }}</span>
          {% else %}
            <span class="amount-label">Quitado</span>
            <span class="amount-value neutral">R$ 0,00</span>
          {% endif %}
        </div>
        
        {% if balance.amount != 0 %}
        <div class="balance-actions">
          <button class="btn-settle" data-settle-balance="{{ balance.id }}">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            Quitar
          </button>
        </div>
        {% endif %}
      </div>
      {% endfor %}
    {% else %}
    <div class="empty-state">
      <div class="empty-state-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0012 4C7.272 4 3.25 5.14 0 7.25v12.5A48.416 48.416 0 0012 20.25c4.728 0 8.75-1.14 12-3.25V7.25A48.416 48.416 0 0012 4z"/>
        </svg>
      </div>
      <h3>Todos os saldos quitados</h3>
      <p>Não há pendências entre os membros do grupo</p>
    </div>
    {% endif %}
  </div>

  <!-- Settlement Suggestions -->
  {% if settlement_suggestions %}
  <div class="settlement-suggestions">
    <h3>Sugestões de Acerto</h3>
    <p class="suggestions-subtitle">Minimize o número de transações</p>
    
    <div class="suggestions-list">
      {% for suggestion in settlement_suggestions %}
      <div class="suggestion-item">
        <div class="suggestion-content">
          <div class="suggestion-users">
            <span class="from-user">{{ suggestion.from_user.name }}</span>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="suggestion-arrow">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
            </svg>
            <span class="to-user">{{ suggestion.to_user.name }}</span>
          </div>
          
          <div class="suggestion-amount">
            R$ {{ "%.2f"|format(suggestion.amount)|replace(".", ",") }}
          </div>
        </div>
        
        <button class="btn-apply-suggestion" data-suggestion="{{ suggestion.id }}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
          </svg>
          Aplicar
        </button>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Settlement button functionality
  const settleButtons = document.querySelectorAll('[data-settle-balance]');
  settleButtons.forEach(button => {
    button.addEventListener('click', function() {
      const balanceId = this.getAttribute('data-settle-balance');
      
      if (confirm('Confirma a quitação deste saldo?')) {
        // Here you would make an API call to settle the balance
        // For now, just show a success message
        this.innerHTML = `
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
          </svg>
          Quitado
        `;
        this.disabled = true;
        this.classList.add('settled');
      }
    });
  });
  
  // Settlement suggestion functionality
  const suggestionButtons = document.querySelectorAll('[data-suggestion]');
  suggestionButtons.forEach(button => {
    button.addEventListener('click', function() {
      const suggestionId = this.getAttribute('data-suggestion');
      
      if (confirm('Aplicar esta sugestão de acerto?')) {
        // Here you would make an API call to apply the settlement suggestion
        this.innerHTML = `
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
          </svg>
          Aplicado
        `;
        this.disabled = true;
        this.classList.add('applied');
      }
    });
  });
});
</script>