{% extends 'base.html' %}
{% block content %}

{% if is_authenticated %}
<!-- Authenticated User View -->
<div class="authenticated-header">
  <div class="user-info">
    <div class="user-avatar">{{ current_user.name[0].upper() }}</div>
    <div>
      <h2>Olá, {{ current_user.name }}!</h2>
      <p>{{ current_user.email }}</p>
    </div>
  </div>
  <form method="post" action="/logout" style="display: inline;">
    <button type="submit" class="btn-secondary">Sair</button>
  </form>
</div>

<!-- Balance Overview -->
<div class="balance-overview">
  <div class="balance-cards">
    <div class="balance-card positive">
      <div class="balance-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
        </svg>
      </div>
      <div class="balance-content">
        <h3>Você Recebe</h3>
        <span class="amount">R$ 0,00</span>
      </div>
    </div>
    
    <div class="balance-card negative">
      <div class="balance-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
        </svg>
      </div>
      <div class="balance-content">
        <h3>Você Deve</h3>
        <span class="amount">R$ 0,00</span>
      </div>
    </div>
    
    <div class="balance-card neutral">
      <div class="balance-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
        </svg>
      </div>
      <div class="balance-content">
        <h3>Total Gasto</h3>
        <span class="amount">R$ 0,00</span>
      </div>
    </div>
  </div>
</div>

<!-- Recent Activity -->
<div class="activity-section">
  <div class="section-header">
    <div class="section-icon">
      <div class="section-icon-inner" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
      </div>
    </div>
    <div>
      <h2>Atividade Recente</h2>
      <p>Últimas movimentações nos seus grupos</p>
    </div>
  </div>
  
  <div class="activity-feed">
    <div class="activity-item">
      <div class="activity-icon welcome">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
        </svg>
      </div>
      <div class="activity-content">
        <p><strong>Bem-vindo ao DividaFácil!</strong></p>
        <p class="activity-description">Comece criando usuários e grupos para dividir suas despesas</p>
        <span class="activity-time">Agora</span>
      </div>
    </div>
  </div>
</div>

<!-- Main Grid -->
<div class="main-grid">

<style>
.authenticated-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: white;
  padding: 1.5rem 2rem;
  border-radius: 1rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  margin-bottom: 2rem;
}

.user-info {
  display: flex;
  align-items: center;
  gap: 1rem;

  font-size: 0.875rem;
  margin: 0;
}

.btn-secondary {
  background-color: white;
  color: #374151;
  border: 1px solid #d1d5db;
  padding: 0.75rem 1.5rem;
  border-radius: 0.5rem;
  font-weight: 600;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-secondary:hover {
  background-color: #f3f4f6;
}
</style>
  <!-- Users Section -->
  <section class="section">
    <div class="section-header">
      <div class="section-icon">
        <div class="section-icon-inner">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.215-.584-7.499-1.632z"/>
          </svg>
        </div>
      </div>
      <div>
        <h2>{{ t('dashboard.users') }}</h2>
        <p>{{ t('dashboard.add_people_to_system') }}</p>
      </div>
    </div>

    <!-- Add User Form -->
    <form action="/users" method="post" target="_self" class="form-card">
      <div class="form-grid">
        <div class="input-group">
          <label class="input-label">{{ t('dashboard.full_name') }}</label>
          <input required name="name" placeholder="{{ t('dashboard.full_name_placeholder') }}" 
                 class="input-field" 
                 aria-label="{{ t('dashboard.user_name_aria') }}" title="{{ t('dashboard.user_name_aria') }}">
        </div>
        <div class="input-group">
          <label class="input-label">{{ t('dashboard.email') }}</label>
          <input required type="email" name="email" placeholder="{{ t('dashboard.email_placeholder') }}" 
                 class="input-field" 
                 aria-label="{{ t('dashboard.user_email_aria') }}" title="{{ t('dashboard.user_email_aria') }}">
        </div>
      </div>
      <div style="display: flex; justify-content: flex-end; padding-top: 0.5rem;">
        <button class="btn-primary" 
                aria-label="{{ t('dashboard.add_user') }}" title="{{ t('dashboard.add_user') }}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" style="width: 1.25rem; height: 1.25rem;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.5v15m7.5-7.5h-15"/>
          </svg>
          {{ t('dashboard.add_user') }}
        </button>
      </div>
    </form>

    <!-- Users List -->
    <div style="display: flex; flex-direction: column; gap: 1rem;">
      <div class="card">
        <div class="card-content">
          <div class="avatar">
            {{ current_user.name[0].upper() }}
          </div>
          <div style="flex: 1;">
            <h3>{{ current_user.name }}</h3>
            <p>{{ current_user.email }}</p>
          </div>
        </div>
      </div>
      {% else %}
      <div class="empty-state">
        <div class="empty-state-icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" style="width: 2rem; height: 2rem; color: white;">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.215-.584-7.499-1.632z"/>
          </svg>
        </div>
        <h3>{{ t('dashboard.no_users_yet') }}</h3>
        <p>{{ t('dashboard.no_users_message') }}</p>
      </div>
      {% endfor %}
    </div>
  </section>

  <!-- Groups Section -->
  <section class="section">
    <div class="section-header">
      <div class="section-icon">
        <div class="section-icon-inner" style="background: linear-gradient(135deg, #06b6d4, #0891b2, #0284c7);">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 15.75v-.3m12 3.27v-.188c0-1.121-.285-2.18-.786-3.104m0 0A5.987 5.987 0 0012 9.75a5.987 5.987 0 00-5.214 3.178m0 0a3 3 0 00-4.682 2.72 8.986 8.986 0 003.741.479"/>
          </svg>
        </div>
      </div>
      <div>
        <h2>{{ t('dashboard.groups') }}</h2>
        <p>{{ t('dashboard.organize_people') }}</p>
      </div>
    </div>

    <!-- Add Group Form -->
    <form action="/groups" method="post" target="_self" class="form-card">
      <div class="input-group" style="margin-bottom: 1.5rem;">
        <label class="input-label">{{ t('forms.group_name') }}</label>
        <input required name="name" placeholder="{{ t('forms.group_name_placeholder') }}" 
               class="input-field" 
               aria-label="{{ t('forms.group_name_aria') }}" title="{{ t('forms.group_name_aria') }}">
      </div>
      
      {% if users %}
      <div class="input-group" style="margin-bottom: 1.5rem;">
        <label class="input-label">{{ t('dashboard.group_members') }}</label>
        <div style="display: grid; grid-template-columns: 1fr; gap: 0.75rem; max-height: 10rem; overflow-y: auto; padding: 1rem; background: linear-gradient(135deg, rgba(248, 250, 252, 0.8), rgba(255, 255, 255, 0.8)); border-radius: 1rem; border: 2px solid rgba(148, 163, 184, 0.6);">
          {% for user in users %}
          <label style="display: inline-flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: rgba(255, 255, 255, 0.8); border-radius: 0.75rem; border: 1px solid rgba(148, 163, 184, 0.4); cursor: pointer; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);" onmouseover="this.style.background='rgba(255, 255, 255, 0.95)'; this.style.transform='scale(1.02)'; this.style.boxShadow='0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)';" onmouseout="this.style.background='rgba(255, 255, 255, 0.8)'; this.style.transform='scale(1)'; this.style.boxShadow='none';">
            <input type="checkbox" name="member_ids" value="{{ user.id }}" 
                   style="width: 1rem; height: 1rem; accent-color: #06b6d4; border: 1px solid #cbd5e1; border-radius: 0.25rem;" 
                   aria-label="Incluir {{ user.name }} no grupo" title="Incluir {{ user.name }} no grupo">
            <div style="width: 2rem; height: 2rem; background: linear-gradient(135deg, #06b6d4, #0284c7); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04);">
              <span style="color: white; font-weight: 900; font-size: 0.875rem;">{{ user.name[0].upper() }}</span>
            </div>
            <span style="font-size: 0.875rem; font-weight: 700; color: #374151;">{{ user.name }}</span>
          </label>
          {% endfor %}
        </div>
      </div>
      {% endif %}
      
      <div style="display: flex; justify-content: flex-end; padding-top: 0.5rem;">
        <button class="btn-secondary" 
                aria-label="{{ t('dashboard.create_group') }}" title="{{ t('dashboard.create_group') }}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" style="width: 1.25rem; height: 1.25rem;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.5v15m7.5-7.5h-15"/>
          </svg>
          Criar grupo
        </button>
      </div>
    </form>

    <!-- Groups List -->
    <div style="display: flex; flex-direction: column; gap: 1rem;">
      {% for group in groups %}
      <div class="card">
        <div class="card-content">
          <div class="avatar" style="background: linear-gradient(135deg, #06b6d4, #0891b2, #0284c7);">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" style="width: 1.5rem; height: 1.5rem; color: white;">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 15.75v-.3m12 3.27v-.188c0-1.121-.285-2.18-.786-3.104m0 0A5.987 5.987 0 0012 9.75a5.987 5.987 0 00-5.214 3.178m0 0a3 3 0 00-4.682 2.72 8.986 8.986 0 003.741.479"/>
            </svg>
          </div>
          <div style="flex: 1;">
            <h3>{{ group.name }}</h3>
            <p>{{ group.members|length }} membros</p>
          </div>
          <a href="/groups/{{ group.id }}" 
             class="btn-primary" style="padding: 0.75rem 1.5rem; font-size: 0.875rem;"
             aria-label="Abrir grupo {{ group.name }}" title="Abrir grupo {{ group.name }}">
            Abrir
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" style="width: 1rem; height: 1rem;">
              <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"/>
            </svg>
          </a>
        </div>
      </div>
      {% else %}
      <div class="empty-state">
        <div class="empty-state-icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" style="width: 2rem; height: 2rem; color: white;">
            <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 15.75v-.3m12 3.27v-.188c0-1.121-.285-2.18-.786-3.104m0 0A5.987 5.987 0 0012 9.75a5.987 5.987 0 00-5.214 3.178m0 0a3 3 0 00-4.682 2.72 8.986 8.986 0 003.741.479"/>
          </svg>
        </div>
        <h3>Nenhum grupo ainda</h3>
        <p>Crie um grupo para começar a dividir despesas</p>
      </div>
      {% endfor %}
    </div>
  </section>
</div>

<!-- Quick Stats -->
{% if users or groups %}
<div class="stats-grid">
  <div class="stat-card">
    <div class="stat-icon">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.215-.584-7.499-1.632z"/>
      </svg>
    </div>
    <div class="stat-number">{{ users|length }}</div>
    <div class="stat-label">Usuários cadastrados</div>
  </div>
  
  <div class="stat-card">
    <div class="stat-icon" style="background: linear-gradient(135deg, #06b6d4, #0891b2, #0284c7);">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 15.75v-.3m12 3.27v-.188c0-1.121-.285-2.18-.786-3.104m0 0A5.987 5.987 0 0012 9.75a5.987 5.987 0 00-5.214 3.178m0 0a3 3 0 00-4.682 2.72 8.986 8.986 0 003.741.479"/>
      </svg>
    </div>
    <div class="stat-number">{{ groups|length }}</div>
    <div class="stat-label">Grupos criados</div>
  </div>
  
  <div class="stat-card">
    <div class="stat-icon" style="background: linear-gradient(135deg, #22c55e, #16a34a);">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"/>
      </svg>
    </div>
    <div class="stat-number">{{ total_expenses or 0 }}</div>
    <div class="stat-label">Despesas registradas</div>
  </div>
</div>
{% endif %}
{% endif %}
{% endblock %}
