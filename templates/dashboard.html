{% extends 'base.html' %}
{% block content %}

<!-- Authenticated User View (user guaranteed authenticated by route) -->
<div class="authenticated-header">
  <div class="user-info">
    <div class="user-avatar">{{ current_user.name[0].upper() }}</div>
    <div>
      <h2>Olá, {{ current_user.name }}!</h2>
      <p>{{ current_user.email }}</p>
    </div>
  </div>
  <form method="post" action="/logout" class="inline-form">
    <button type="submit" class="btn-secondary">Sair</button>
  </form>
</div>

<!-- Balance Overview -->
<div class="balance-overview">
  <div class="balance-cards">
    <div class="balance-card positive">
      <div class="balance-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
        </svg>
      </div>
      <div class="balance-content">
        <h3>Você Recebe</h3>
        <span class="amount">R$ 0,00</span>
      </div>
    </div>
    
    <div class="balance-card negative">
      <div class="balance-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
        </svg>
      </div>
      <div class="balance-content">
        <h3>Você Deve</h3>
        <span class="amount">R$ 0,00</span>
      </div>
    </div>
    
    <div class="balance-card neutral">
      <div class="balance-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
        </svg>
      </div>
      <div class="balance-content">
        <h3>Total Gasto</h3>
        <span class="amount">R$ 0,00</span>
      </div>
    </div>
  </div>
</div>

<!-- Desktop Two-Column Layout Wrapper -->
<div class="dashboard-layout">
  <!-- Main Column (Groups / future content) -->
  <div class="main-column">
    <!-- Groups Section -->
    <section class="section">
      <div class="section-header">
        <div class="section-icon">
          <div class="section-icon-inner gradient-cyan">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 15.75v-.3m12 3.27v-.188c0-1.121-.285-2.18-.786-3.104m0 0A5.987 5.987 0 0012 9.75a5.987 5.987 0 00-5.214 3.178m0 0a3 3 0 00-4.682 2.72 8.986 8.986 0 003.741.479"/>
            </svg>
          </div>
        </div>
        <div>
          <h2>{{ t('dashboard.groups') }}</h2>
          <p>{{ t('dashboard.organize_people') }}</p>
        </div>
      </div>

      <!-- Add Group Form -->
      <form id="group-form" action="/groups" method="post" target="_self" class="form-card">
        <div class="input-group mb-6">
          <label class="input-label">{{ t('forms.group_name') }}</label>
          <input required name="name" placeholder="{{ t('forms.group_name_placeholder') }}"
                 class="input-field"
                 aria-label="{{ t('forms.group_name_aria') }}" title="{{ t('forms.group_name_aria') }}">
        </div>
        {% if users %}
        <div class="input-group mb-6">
          <label class="input-label">{{ t('dashboard.group_members') }}</label>
          <div class="group-member-picker">
            {% for user in users %}
            <label class="group-member-option">
              <input type="checkbox" name="member_ids" value="{{ user.id }}"
                     aria-label="Incluir {{ user.name }} no grupo" title="Incluir {{ user.name }} no grupo">
              <div class="group-member-avatar">
                <span>{{ user.name[0].upper() }}</span>
              </div>
              <span class="group-member-name">{{ user.name }}</span>
            </label>
            {% endfor %}
          </div>
        </div>
        {% endif %}
        <div class="actions-row">
          <button class="btn-secondary"
                  aria-label="{{ t('dashboard.create_group') }}" title="{{ t('dashboard.create_group') }}">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.5v15m7.5-7.5h-15"/>
            </svg>
            Criar grupo
          </button>
        </div>
      </form>

      <!-- Groups List -->
      <div class="groups-list list-divided">
        {% for group in groups %}
        <div class="card">
          <div class="card-content">
            <div class="avatar gradient-cyan">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 15.75v-.3m12 3.27v-.188c0-1.121-.285-2.18-.786-3.104m0 0A5.987 5.987 0 0012 9.75a5.987 5.987 0 00-5.214 3.178m0 0a3 3 0 00-4.682 2.72 8.986 8.986 0 003.741.479"/>
              </svg>
            </div>
            <div class="flex-1">
              <h3>{{ group.name }}</h3>
              <p>{{ group.members|length }} membros</p>
            </div>
            <a href="/groups/{{ group.id }}"
               class="btn-primary btn--sm"
               aria-label="Abrir grupo {{ group.name }}" title="Abrir grupo {{ group.name }}">
              Abrir
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"/>
              </svg>
            </a>
          </div>
        </div>
        {% else %}
        <div class="empty-state">
          <div class="empty-state-icon gradient-cyan">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 15.75v-.3m12 3.27v-.188c0-1.121-.285-2.18-.786-3.104m0 0A5.987 5.987 0 0012 9.75a5.987 5.987 0 00-5.214 3.178m0 0a3 3 0 00-4.682 2.72 8.986 8.986 0 003.741.479"/>
            </svg>
          </div>
          <h3>Nenhum grupo ainda</h3>
          <p>Crie um grupo para começar a dividir despesas</p>
          <a href="#group-form" class="btn-primary cta-btn btn--sm">Criar primeiro grupo</a>
        </div>
        {% endfor %}
      </div>
    </section>
  </div>

  <!-- Sidebar Column (Activity + Stats) -->
  <div class="sidebar-column">
    <!-- Recent Activity -->
    <div class="activity-section">
      <div class="section-header">
        <div class="section-icon">
          <div class="section-icon-inner gradient-violet">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </div>
        </div>
        <div>
          <h2>Atividade Recente</h2>
          <p>Últimas movimentações nos seus grupos</p>
        </div>
      </div>

      <div class="activity-feed">
        <div class="activity-item">
          <div class="activity-icon gradient-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
            </svg>
          </div>
          <div class="activity-content">
            <p><strong>Bem-vindo ao DividaFácil!</strong></p>
            <p class="activity-description">Comece criando usuários e grupos para dividir suas despesas</p>
            <span class="activity-time">Agora</span>
          </div>
        </div>
      </div>
    </div>

  </div> <!-- /.sidebar-column -->
</div> <!-- /.dashboard-layout -->

{% endblock %}
